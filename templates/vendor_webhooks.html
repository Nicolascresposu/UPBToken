{% extends "base.html" %}
{% block content %}
<h2>Webhook settings</h2>

<p>
  Configure a URL that will receive a POST request with JSON whenever one of your
  products is purchased.
</p>
<p>
  We'll send a payload like:
</p>
<pre><code>{
  "event": "purchase.created",
  "purchase": { ... },
  "vendor": { ... }
}</code></pre>

<form method="post" class="mt-3" style="max-width: 600px;">
  {% csrf_token %}
  <div class="mb-3">
    <label for="url" class="form-label">Webhook URL</label>
    <input
      type="url"
      class="form-control"
      id="url"
      name="url"
      value="{{ webhook.url }}"
      placeholder="https://example.com/webhooks/upbolis"
      required
    >
  </div>

  <div class="mb-3">
    <label for="secret" class="form-label">Secret (optional)</label>
    <input
      type="text"
      class="form-control"
      id="secret"
      name="secret"
      value="{{ webhook.secret }}"
      placeholder="Used to sign the payload (HMAC SHA-256)"
    >
    <div class="form-text">
      If set, we will send <code>X-UPBT-Signature</code> header (HMAC-SHA256).
    </div>
  </div>

  <div class="form-check mb-3">
    <input
      class="form-check-input"
      type="checkbox"
      id="is_active"
      name="is_active"
      {% if webhook.is_active %}checked{% endif %}
    >
    <label class="form-check-label" for="is_active">
      Enable webhook
    </label>
  </div>

  <button type="submit" class="btn btn-primary">Save</button>
</form>
{% endblock %}
